{"ast":null,"code":"import _defineProperty from\"/Users/jay_lohokare/Desktop/PPL Codes/webgl-3d-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/jay_lohokare/Desktop/PPL Codes/webgl-3d-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"/Users/jay_lohokare/Desktop/PPL Codes/webgl-3d-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/jay_lohokare/Desktop/PPL Codes/webgl-3d-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/jay_lohokare/Desktop/PPL Codes/webgl-3d-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/jay_lohokare/Desktop/PPL Codes/webgl-3d-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{PureComponent}from\"react\";import{fromJS}from\"immutable\";import MAP_STYLE from\"../map-style-basic-v8.json\";import{inject,observer}from\"mobx-react\";import Materialize from\"materialize-css\";var defaultMapStyle=fromJS(MAP_STYLE);var categories=[\"labels\",\"roads\",\"buildings\",\"parks\",\"water\",\"background\",\"connectivity\",\"models\"];// Layer id patterns by category\nvar layerSelector={background:/background/,water:/water/,parks:/park/,buildings:/building/,roads:/bridge|road|tunnel/,labels:/label|place|poi/,connectivity:/trips-layer/,models:/model-layer/};// Layer color class by type\nvar colorClass={line:\"line-color\",fill:\"fill-color\",background:\"background-color\",symbol:\"text-color\"};var StyleControls=/*#__PURE__*/function(_PureComponent){_inherits(StyleControls,_PureComponent);var _super=_createSuper(StyleControls);function StyleControls(props){var _this;_classCallCheck(this,StyleControls);_this=_super.call(this,props);_this._defaultLayers=defaultMapStyle.get(\"layers\");_this.state={visibility:{water:true,parks:true,buildings:true,roads:true,labels:true,background:true,connectivity:false,models:true},color:{water:\"#DBE2E6\",parks:\"#E6EAE9\",buildings:\"#c0c0c8\",roads:\"#ffffff\",labels:\"#78888a\",background:\"#EBF0F0\"}};return _this;}_createClass(StyleControls,[{key:\"componentDidMount\",value:function componentDidMount(){this._updateMapStyle(this.state);Materialize.Modal.init(document.querySelectorAll(\".modal\"));Materialize.Tooltip.init(document.querySelectorAll(\".tooltipped\"));}},{key:\"_onColorChange\",value:function _onColorChange(name,event){var color=_objectSpread(_objectSpread({},this.state.color),{},_defineProperty({},name,event.target.value));this.setState({color:color});this._updateMapStyle(_objectSpread(_objectSpread({},this.state),{},{color:color}));}},{key:\"_onVisibilityChange\",value:function _onVisibilityChange(name,event){var visibility=_objectSpread(_objectSpread({},this.state.visibility),{},_defineProperty({},name,event.target.checked));this.setState({visibility:visibility});this._updateMapStyle(_objectSpread(_objectSpread({},this.state),{},{visibility:visibility}));this.props.toggleParent(name,event.target.checked);}},{key:\"_updateMapStyle\",value:function _updateMapStyle(_ref){var visibility=_ref.visibility,color=_ref.color;var layers=this._defaultLayers.filter(function(layer){var id=layer.get(\"id\");return categories.every(function(name){return visibility[name]||!layerSelector[name].test(id);});}).map(function(layer){var id=layer.get(\"id\");var type=layer.get(\"type\");var category=categories.find(function(name){return layerSelector[name].test(id);});if(category&&colorClass[type]){return layer.setIn([\"paint\",colorClass[type]],color[category]);}return layer;});this.props.setMapStyle(defaultMapStyle.set(\"layers\",layers));}},{key:\"_renderLayerControl\",value:function _renderLayerControl(name){var _this$state=this.state,visibility=_this$state.visibility,color=_this$state.color;return/*#__PURE__*/React.createElement(\"div\",{key:name},/*#__PURE__*/React.createElement(\"label\",{className:\"input \",width:\"200%\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"input\",{className:\"col s2 m2 l2\",type:\"checkbox\",checked:visibility[name],onChange:this._onVisibilityChange.bind(this,name)}),/*#__PURE__*/React.createElement(\"span\",{className:\"col s7 m7 l4 center-aligned center offset-m1 offset-l3 offset-s1\"},name),name===\"connectivity\"||name===\"models\"?null:/*#__PURE__*/React.createElement(\"input\",{className:\"col s2 m2 l1\",type:\"color\",value:color[name],disabled:!visibility[name],onChange:this._onColorChange.bind(this,name)}))));}},{key:\"render\",value:function render(){var _this2=this;return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{id:\"modal1\",className:\"modal\"},/*#__PURE__*/React.createElement(\"div\",{className:\"layers-modal-header black\"},/*#__PURE__*/React.createElement(\"h4\",{className:\"white-text center-align\"},\"Edit Layers\")),/*#__PURE__*/React.createElement(\"div\",{className:\"modal-content container center-align\"},/*#__PURE__*/React.createElement(\"div\",null,categories.map(function(name){return _this2._renderLayerControl(name);})))));}}]);return StyleControls;}(PureComponent);export default inject(\"store\")(observer(StyleControls));","map":{"version":3,"sources":["/Users/jay_lohokare/Desktop/PPL Codes/webgl-3d-web/src/webGL/control-panel.js"],"names":["React","PureComponent","fromJS","MAP_STYLE","inject","observer","Materialize","defaultMapStyle","categories","layerSelector","background","water","parks","buildings","roads","labels","connectivity","models","colorClass","line","fill","symbol","StyleControls","props","_defaultLayers","get","state","visibility","color","_updateMapStyle","Modal","init","document","querySelectorAll","Tooltip","name","event","target","value","setState","checked","toggleParent","layers","filter","layer","id","every","test","map","type","category","find","setIn","setMapStyle","set","_onVisibilityChange","bind","_onColorChange","_renderLayerControl"],"mappings":"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","sourcesContent":["import React, { PureComponent } from \"react\";\nimport { fromJS } from \"immutable\";\nimport MAP_STYLE from \"../map-style-basic-v8.json\";\nimport { inject, observer } from \"mobx-react\";\nimport Materialize from \"materialize-css\";\n\nconst defaultMapStyle = fromJS(MAP_STYLE);\nconst categories = [\n  \"labels\",\n  \"roads\",\n  \"buildings\",\n  \"parks\",\n  \"water\",\n  \"background\",\n  \"connectivity\",\n  \"models\",\n];\n\n// Layer id patterns by category\nconst layerSelector = {\n  background: /background/,\n  water: /water/,\n  parks: /park/,\n  buildings: /building/,\n  roads: /bridge|road|tunnel/,\n  labels: /label|place|poi/,\n  connectivity: /trips-layer/,\n  models: /model-layer/,\n};\n\n// Layer color class by type\nconst colorClass = {\n  line: \"line-color\",\n  fill: \"fill-color\",\n  background: \"background-color\",\n  symbol: \"text-color\",\n};\n\nclass StyleControls extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    this._defaultLayers = defaultMapStyle.get(\"layers\");\n\n    this.state = {\n      visibility: {\n        water: true,\n        parks: true,\n        buildings: true,\n        roads: true,\n        labels: true,\n        background: true,\n        connectivity: false,\n        models: true,\n      },\n      color: {\n        water: \"#DBE2E6\",\n        parks: \"#E6EAE9\",\n        buildings: \"#c0c0c8\",\n        roads: \"#ffffff\",\n        labels: \"#78888a\",\n        background: \"#EBF0F0\",\n      },\n    };\n  }\n\n  componentDidMount() {\n    this._updateMapStyle(this.state);\n\n    Materialize.Modal.init(document.querySelectorAll(\".modal\"));\n    Materialize.Tooltip.init(document.querySelectorAll(\".tooltipped\"));\n  }\n\n  _onColorChange(name, event) {\n    const color = { ...this.state.color, [name]: event.target.value };\n    this.setState({ color });\n    this._updateMapStyle({ ...this.state, color });\n  }\n\n  _onVisibilityChange(name, event) {\n    const visibility = {\n      ...this.state.visibility,\n      [name]: event.target.checked,\n    };\n    this.setState({ visibility });\n    this._updateMapStyle({ ...this.state, visibility });\n    this.props.toggleParent(name, event.target.checked);\n  }\n\n  _updateMapStyle({ visibility, color }) {\n    const layers = this._defaultLayers\n      .filter((layer) => {\n        const id = layer.get(\"id\");\n        return categories.every(\n          (name) => visibility[name] || !layerSelector[name].test(id)\n        );\n      })\n      .map((layer) => {\n        const id = layer.get(\"id\");\n        const type = layer.get(\"type\");\n        const category = categories.find((name) =>\n          layerSelector[name].test(id)\n        );\n        if (category && colorClass[type]) {\n          return layer.setIn([\"paint\", colorClass[type]], color[category]);\n        }\n        return layer;\n      });\n    this.props.setMapStyle(defaultMapStyle.set(\"layers\", layers));\n  }\n\n  _renderLayerControl(name) {\n    const { visibility, color } = this.state;\n    return (\n      <div key={name}>\n        <label className=\"input \" width=\"200%\">\n          <div className=\"row\">\n            <input\n              className=\"col s2 m2 l2\"\n              type=\"checkbox\"\n              checked={visibility[name]}\n              onChange={this._onVisibilityChange.bind(this, name)}\n            />\n\n            <span className=\"col s7 m7 l4 center-aligned center offset-m1 offset-l3 offset-s1\">\n              {name}\n            </span>\n\n            {name === \"connectivity\" || name === \"models\" ? null : (\n              <input\n                className=\"col s2 m2 l1\"\n                type=\"color\"\n                value={color[name]}\n                disabled={!visibility[name]}\n                onChange={this._onColorChange.bind(this, name)}\n              />\n            )}\n          </div>\n        </label>\n      </div>\n    );\n  }\n\n  render() {\n    return (\n      <div>\n        \n        <div id=\"modal1\" className=\"modal\">\n          <div className=\"layers-modal-header black\">\n            <h4 className=\"white-text center-align\">Edit Layers</h4>\n          </div>\n          <div className=\"modal-content container center-align\">\n            <div>\n              {categories.map((name) => this._renderLayerControl(name))}\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default inject(\"store\")(observer(StyleControls));\n"]},"metadata":{},"sourceType":"module"}